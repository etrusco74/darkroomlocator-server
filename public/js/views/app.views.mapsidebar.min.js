app.views.mapsidebar=Backbone.View.extend({initialize:function(){console.log("initializing map sidebar view")},events:{submit:"search","click #btnReset":"reset"},render:function(){$(this.el).html(this.template());this.renderTypesCollectionToSelect();this.$("#mapsidebarForm").validate({rules:{geocomplete:"required"},messages:this.language.form_messages});return this},init_geo:function(){this.$("#geocomplete").geocomplete();this.$("#geocomplete").bind("geocode:result",function(e,t){console.log(t);app.global.lng_txt=t.geometry.location.lng();app.global.lat_txt=t.geometry.location.lat()})},formToJson:function(){var e={};var t=app.global.lng_txt;var n=app.global.lat_txt;e.lng=t;e.lat=n;e.km=$("#km").val();$("#search").val()==""?e.text="null":e.text=$("#search").val().replace(" ","|");e.id=$("#reportTypes").val();return e},search:function(e){console.log(e);e.preventDefault();var t=this.formToJson();app.global.mapdashboardView.renderReportsCollectionToMaps(t)},reset:function(){app.global.lat_txt=0;app.global.lng_txt=0;$("#geocomplete").val("");$("#km").val(0).attr("selected",true);$("#reportTypes").val(0).attr("selected",true);$("#search").val("");app.global.mapdashboardView.init_map()},renderTypesCollectionToSelect:function(){var e=this;var t=new app.collections.types;t.fetch({success:function(){console.log(t.models);for(var n=0 in t.models){$("#reportTypes").append($("<option></option>").attr("value",t.models[n].get("_id")).text(t.models[n].get("description_"+e.language.lang).trim()))}},error:function(t,n){bootbox.dialog({title:e.language.error_message_type,message:e.language.error_message_type,buttons:{main:{label:e.language.label_button,className:"btn btn-danger",callback:function(){$("body").removeClass("modal-open")}}}})},url:app.const.apiurl()+"types"})},destroy_view:function(){this.undelegateEvents();$(this.el).removeData().unbind();this.remove();Backbone.View.prototype.remove.call(this);app.global.mapsidebarView=null}})