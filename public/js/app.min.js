app={collections:{},models:{},routers:{},views:{},utils:{init:function(e){app.utils.loadTemplate(["index","login","registration","profile","dashboard","footer","navbar","sidebar","report","mapdashboard","mapdashboardsingle","mapsidebar","credits","project","password","resend","activate","error","adlarge","admedium","adsmall","help"],function(){app.utils.loadLanguage(["index","login","registration","profile","dashboard","footer","navbar","sidebar","report","mapdashboard","mapdashboardsingle","mapsidebar","credits","project","password","resend","activate","error","help"],function(){if(e){app.router=new app.routers.router;try{Backbone.history.start()}catch(t){}}else app.routers.router.prototype.index()})})},loadTokens:function(){app.global.tokensCollection=new app.collections.tokens;app.global.tokensCollection.fetch()},getLanguage:function(){app.global.languagesCollection=new app.collections.languages;app.global.languagesCollection.fetch();var e=app.global.default_language();if(app.global.languagesCollection.length>0){e=app.global.languagesCollection.at(0).get("lang");if($.inArray(e,app.languages)==-1){e=app.global.default_language();this.setLanguage(e)}}else{this.setLanguage(e)}return e},setLanguage:function(e){app.global.languagesCollection=new app.collections.languages;app.global.languagesCollection.fetch();if(app.global.languagesCollection.length>0){app.global.languagesCollection.each(function(e){e.destroy()})}if(!_.contains(app.languages,e)){e=app.global.default_language()}var t=new app.models.language({lang:e});app.global.languagesCollection.add(t);t.save()},loadTemplate:function(e,t){var n=app.utils.getLanguage();var r=[];$.each(e,function(e,t){if(app.views[t]){r.push($.get("js/templates/"+n+"/app.templates."+t+".html",function(e){app.views[t].prototype.template=_.template(e)}))}else{alert(t+" not found")}});$.when.apply(null,r).done(t)},loadLanguage:function(e,t){var n=app.utils.getLanguage();var r=[];$.each(e,function(e,t){if(app.views[t]){r.push($.getJSON("js/languages/"+n+"/app.languages."+t+".json",function(e){app.views[t].prototype.language=e}))}else{alert(t+" not found")}});$.when.apply(null,r).done(t)},destroyViews:function(){if(app.global.indexView){app.global.indexView.destroy_view()}if(app.global.navbarView){app.global.navbarView.destroy_view()}if(app.global.footerView){app.global.footerView.destroy_view()}if(app.global.loginView){app.global.loginView.destroy_view()}if(app.global.registrationView){app.global.registrationView.destroy_view()}if(app.global.mapdashboardView){app.global.mapdashboardView.destroy_view()}if(app.global.mapdashboardsingleView){app.global.mapdashboardsingleView.destroy_view()}if(app.global.mapsidebarView){app.global.mapsidebarView.destroy_view()}if(app.global.creditsView){app.global.creditsView.destroy_view()}if(app.global.helpView){app.global.helpView.destroy_view()}if(app.global.projectView){app.global.projectView.destroy_view()}if(app.global.activateView){app.global.activateView.destroy_view()}if(app.global.resendView){app.global.resendView.destroy_view()}if(app.global.errorView){app.global.errorView.destroy_view()}if(app.global.dashboardView){app.global.dashboardView.destroy_view()}if(app.global.sidebarView){app.global.sidebarView.destroy_view()}if(app.global.profileView){app.global.profileView.destroy_view()}if(app.global.reportView){app.global.reportView.destroy_view()}if(app.global.passwordView){app.global.passwordView.destroy_view()}}},"const":{env:"production",weburl:function(){var e;switch(this.env){case"development":e="http://darkroomlocator-server-c9-etrusco.c9.io/";break;case"test":e="http://darkroomlocator-test.herokuapp.com/";break;default:e="http://www.darkroomlocator.com/"}return e},apiurl:function(){return this.weburl()+"api/"},version:"3.1.0"},global:{map:null,markers_array:[],init_zoom:6,type_value:"1",lat_txt:0,lng_txt:0,slider:null,default_language:function(){var e=window.navigator.userLanguage||window.navigator.language;e=e.substring(0,2);if($.inArray(e,app.languages)==-1){e="en"}return e}},languages:["en","it","de"]}